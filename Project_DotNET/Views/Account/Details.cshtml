@model Project_DotNET.Models.DetailsUserViewModel


<h2>@Model.title</h2>
<div>
    <h4>Informations générales</h4><br />
    <div class="row">
        @Html.LabelFor(m => m.SelectedUser, new { @class = "col-md-2" })
        @Model.fullName
    </div>
    <div class="row">
        @Html.LabelFor(m => m.birthday, new { @class = "col-md-2" })
        @Model.birthday.ToString("dd MMM yyyy")
    </div>
<p/>

<h4>Expériences précédentes <button class="btn-primary" onclick="addJob()">Ajouter une expérience au profil</button></h4> <br />
<table id="list" class="table table-striped table-hover dt-responsive">
    <thead>
        <tr>
            <td>Début de la période</td>
            <td>Fin de la période</td>
            <td>Métier exercé</td>
            <td>Entreprise</td>
            <td>Ville</td>
            <td>Rôle(s) occupé(s)</td>
            <td>Actions</td>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>@Model.user.firstDay.ToString("dd MMM yyyy")</td>
            <td>En cours</td>
            <td>@Model.user.Job.JobName</td>
            <td>@Model.user.Company.CompanyName</td>
            <td>@Model.user.Company.city</td>
            <td>En construction</td>
            <td>En construction
                <!--<button class="btn-primary" onclick="location.href='/Manage/EditPeriod?=&userId=@Model.user.Id'">Editer</button>
                    -->
            </td>
        </tr>
        @foreach (var tperiod in Model.user.Periods){
                        <tr>
                <td>@tperiod.debut.ToString("dd MMM yyyy")</td>
                <td>@tperiod.fin.ToString("dd MMM yyyy")</td>
                <td>@tperiod.Job.JobName</td>
                <td>@tperiod.Company.CompanyName</td>
                <td>@tperiod.Company.city</td>
                <td>
                    <ul>
                        @foreach (var role in @tperiod.AppRole.AppRoles)
                        {
                            <li>@role.AvailableRoleName</li>
                        }
                    </ul>
                </td>
                <td>
                    <button class="btn-primary" onclick="location.href='/Manage/EditPeriod?periodId=@tperiod.PeriodId&userId=@Model.user.Id'">Editer</button>
                    <button class="btn-primary" onclick="location.href='/Manage/DeletePeriod?periodId=@tperiod.PeriodId&userId=@Model.user.Id'">Supprimer</button>
                </td>
            </tr>
        }
    </tbody>
</table>
</div>

@section css{
    <link href="//cdn.datatables.net/1.10.9/css/jquery.dataTables.min.css" rel="stylesheet" />
}

@section scripts{
    <script src="//cdn.datatables.net/1.10.9/js/jquery.dataTables.min.js"></script>
    <script>
        $(document).ready(function () {
            $("#list").DataTable();

            $("#list tbody select").click(function () {
                window.location.href = '/Account/AppUser/' + $(this)[0].value;
            });
        })
        function addJob() {
            window.location.href = '/Manage/AddJobToUser';
        }

        function editPeriod(e) {
            window.location.href = '/Manage/EditPeriod/' + e.value;
        }
    </script>
}