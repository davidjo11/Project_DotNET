@model Project_DotNET.Models.EditPeriodViewModel

<h2>@Model.Title</h2>
<div>



    @Html.AntiForgeryToken()
    <h4>Informations générales</h4><br />
    <p>
        <div class="row">
            @Html.LabelFor(m => m.SelectedUser, new { @class = "col-md-2" })
            @Model.user.lastName @Model.user.firstName
        </div>
        <div class="row">
            @Html.LabelFor(m => m.birthday, new { @class = "col-md-2" })
            @Model.birthday.ToString("dd MMM yyyy")
        </div>
    </p>
    @using (Html.BeginForm("EditPeriod", "Manage", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
    {
        <hr />
        @Html.ValidationSummary("", new { @class = "text-danger" })
        <div class="form-group">
            <div class="form-group">
                @Html.LabelFor(m => m.period.debut, new { @class = "col-md-2 control-label" })
                <div class="col-md-10">
                    @Html.TextBoxFor(m => m.period.debut, new { @class = "form-control", @type = "date", @Value = Model.period.debut != null ? Model.period.debut.ToString("yyy MM dd") : @DateTime.Today.AddYears(-1).ToString("yyyy-MM-dd") })
                </div>
                @Html.ValidationMessageFor(m => m.period.debut)
            </div>

            <div class="form-group">
                @Html.LabelFor(m => m.period.fin, new { @class = "col-md-2 control-label" })
                <div class="col-md-10">
                    @Html.TextBoxFor(m => m.period.fin, new { @class = "form-control", @type = "date", @Value = Model.period.fin != null ? Model.period.fin.ToString("yyy MM dd") : @DateTime.Today.ToString("yyyy-MM-dd") })
                </div>
                @Html.ValidationMessageFor(m => m.period.fin)
            </div>

            <div class="form-group">
                @Html.LabelFor(m => m.SelectedJob, new { @class = "col-md-2 control-label" })
                <div class="col-md-10">
                    @Html.DropDownListFor(m => m.SelectedJob, new SelectList(Model.Jobs.Select(j => new SelectListItem() { Text = j.JobId.ToString(), Value = j.JobName }), "Text", "Value", Model.Jobs.First().JobId), "Selectionnez votre métier", new { @class = "form-control" })
                </div>
                @Html.ValidationMessageFor(m => m.SelectedJob)
            </div>

            <div class="form-group">
                @Html.LabelFor(m => m.SelectedCompany, new { @class = "col-md-2 control-label" })
                <div class="col-md-10">
                    @Html.DropDownListFor(m => m.SelectedCompany, new SelectList(Model.Companies.Select(c => new SelectListItem() { Text = c.CompanyId.ToString(), Value = c.CompanyName + ", " + c.city + ", " + c.country }),
                   "Text", "Value", Model.Companies.First().CompanyId), "Selectionnez votre entreprise", new { @class = "form-control" })
                </div>
                @Html.ValidationMessageFor(m => m.SelectedCompany)
            </div>

            <div class="form-group">
                @Html.LabelFor(m => m.NewRole, new { @class = "col-md-2 control-label" })
                <div class="col-md-10">
                    @Html.DropDownListFor(m => m.NewRole, new SelectList(Model.AvailableRole.Select(ar => new SelectListItem() { Value = ar.AvailableRoleName + ", " + ar.AvailableRoleDesc, Text = ar.AvailableRoleId.ToString() })
                   , "Text", "Value", Model.AvailableRole.First().AvailableRoleId), "Ajouter un nouveau rôle", new { @class = "form-control" })
                </div>
                @Html.ValidationMessageFor(m => m.SelectedCompany)
            </div>



            <div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <input type="submit" class="btn btn-default" value="Valider" />
                    <input type="reset" class="btn btn-default" value="Annuler" onclick="history.back();"/>
                </div>
            </div>
        </div>
    }

    <div class="form-group">
        <div class="row">
            <div class="col-md-4 label-primary">Roles occupés</div>
            <div class="col-md-4 label-primary">Actions</div>
        </div>

            @foreach (var role in Model.period.AppRole.AppRoles)
            {
                <div class="row">
                    <div class="col-md-4">
                        <span title="@role.AvailableRoleDesc">@role.AvailableRoleName</span>
                    </div>
                    <div class="col-md-8">
                        <button class="btn-primary" onclick="location.href='/Manage/DeleteRole?RoledId=@role.AvailableRoleId&userId=@Model.user.Id'">Supprimer</button>
                    </div>
                    </div>
                    }

